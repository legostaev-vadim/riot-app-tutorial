<h3 id="storage-module">Модуль хранения состояния</h3>

В папке **models** создайте файл **User.js**. Наше состояние будет храниться в экземпляре класса **User**. Давайте создадим этот класс, который будет иметь два свойства для хранения данных:

```js
export default class User {

  constructor() {
    this.list = []
    this.current = {}
  }
  
}
```

+ свойство **list** - это список пользователей
+ свойство **current** - это текущий пользователь

> Заметьте, что мы используем **экспорт по умолчанию** для нашего класса. Это обычная практика при работе с модулями, содержащими один единственный класс для экспорта, что не отменяет одновременно и **именованный экспорт**, если в этом возникнет такая необходимость.

Теперь давайте добавим код для загрузки некоторых данных с сервера. Для связи с сервером мы будем использовать [Fetch](https://developer.mozilla.org/ru/docs/Web/API/Fetch_API/Using_Fetch) API, который является [XMLHttpRequest](https://developer.mozilla.org/ru/docs/Web/API/XMLHttpRequest) нового поколения.

Создайте метод **getUsers**, который будет запускать вызов **XHR** и получать список пользователей с сервера:

```js
export default class User {

  constructor() {
    this.list = []
    this.current = {}
  }

  // получаем список пользователей с сервера
  getUsers() {
    
  }
  
}
```

> В этом руководстве, мы будем делать вызовы **XHR** для [REM](http://rem-rest-api.herokuapp.com/) API, который является фиктивным [REST](https://ru.wikipedia.org/wiki/REST) API для быстрого создания прототипов. Этот **API** возвращает список пользователей из конечной точки.

Используя **fetch**, выполним **XHR**-запрос и заполним наш список **list** данными из конечной точки:

```js
export default class User {

  constructor() {
    this.list = []
    this.current = {}
  }

  // получаем список пользователей с сервера
  getUsers() {
    fetch('https://rem-rest-api.herokuapp.com/api/users', {
      method: 'GET',
      credentials: 'include'
    })
      .then(response => response.json())
      .then(result => {
        this.list = result.data
      })
  }
  
}
```

+ свойство **method** - это метод [HTTP](https://ru.wikipedia.org/wiki/HTTP)
+ свойство **credentials** - отвечает за [Cookie](https://ru.wikipedia.org/wiki/Cookie)

В первом аргументе **fetch** передаётся **url** адрес для конечной точки **API**, второй аргумент представляет собой объект с параметрами запроса. В свойстве **method** этого объекта пишем **GET**, а для свойства **credentials** задаём значение **include**, которое указывает на то, что мы используем **куки**, поскольку это является обязательным требованием для [REM](http://rem-rest-api.herokuapp.com/) API.

Вызов **fetch** возвращает **промис**, который, когда ответ будет получен, выполняет функции обратного вызова с объектом [Response](https://developer.mozilla.org/ru/docs/Web/API/Response) или с ошибкой, если запрос не удался. Объект **response** предоставляет методы, позволяющие прочитать тело ответа в необходимом нам формате. В нашем случае, сервер возвращает нам ответ в формате **JSON**, который, с помощью метода **json()** объекта **response** в первом вызове **.then**, преобразуется в объект **JavaScript** и возвращается промис. Следующий **.then** присваивает полученные данные, которые представляют собой массив объектов **JavaScript**, свойству **list** нашего экземпляра класса **User**.

Теперь мы создадим компонет **UserList**, который является представлением и служит для отображения данных из нашего модуля состояния.